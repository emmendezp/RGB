<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Photomosaic # Ejercicio 1
Implement a mosaic (or/and ascii art) visual application. Background # Fotomosaico # En el campo de las imágenes y la fotografía, un fotomosaico es una imagen usualmente una fotografía que ha sido dividida en secciones rectangulares (usualmente del mismo tamaño), tal como es compuesto un mosaico tradicional, con la característica de que cada elemento del mosaico es reemplazado por otra fotografía con colores promedios apropiados al elemento de la imagen original."><meta name=theme-color content="#FFFFFF"><meta name=color-scheme content="light dark"><meta property="og:title" content><meta property="og:description" content="Photomosaic # Ejercicio 1
Implement a mosaic (or/and ascii art) visual application. Background # Fotomosaico # En el campo de las imágenes y la fotografía, un fotomosaico es una imagen usualmente una fotografía que ha sido dividida en secciones rectangulares (usualmente del mismo tamaño), tal como es compuesto un mosaico tradicional, con la característica de que cada elemento del mosaico es reemplazado por otra fotografía con colores promedios apropiados al elemento de la imagen original."><meta property="og:type" content="article"><meta property="og:url" content="https://emmendezp.github.io/RGB/docs/Talleres/Photomosaic/"><meta property="article:section" content="docs"><meta property="article:modified_time" content="2022-11-15T20:29:44-05:00"><title>Photomosaic | Computacion Visual 2022-2 RGB</title><link rel=manifest href=/RGB/manifest.json><link rel=icon href=/RGB/favicon.png type=image/x-icon><link rel=stylesheet href=/RGB/book.min.ab46de3e725a6415339a37bba23a0067534a37289b063c9f8d011515a63097a8.css integrity="sha256-q0bePnJaZBUzmje7ojoAZ1NKNyibBjyfjQEVFaYwl6g=" crossorigin=anonymous><script defer src=/RGB/flexsearch.min.js></script>
<script defer src=/RGB/en.search.min.2e0c2a716b7f43df089aa376ab9188e0ed7246a501a45bb661f86d75904bd9e3.js integrity="sha256-LgwqcWt/Q98ImqN2q5GI4O1yRqUBpFu2YfhtdZBL2eM=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/RGB/><span>Computacion Visual 2022-2 RGB</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><input type=checkbox id=section-bab8b9365022340ebec5653746d3d735 class=toggle>
<label for=section-bab8b9365022340ebec5653746d3d735 class="flex justify-between"><a href=/RGB/docs/Ejercicios/>Ejercicios</a></label><ul><li><a href=/RGB/docs/Ejercicios/Ejercicio1/>Ejercicio1</a></li><li><a href=/RGB/docs/Ejercicios/Ejercicio2/>Ejercicio2</a></li><li><a href=/RGB/docs/Ejercicios/Ejercicio3/>Ejercicio3</a></li></ul></li><li><input type=checkbox id=section-9370f1a5d0248572ac505e0c6d4ad190 class=toggle>
<label for=section-9370f1a5d0248572ac505e0c6d4ad190 class="flex justify-between"><a href=/RGB/docs/shortcodes/>Shortcodes</a></label><ul><li><a href=/RGB/docs/shortcodes/buttons/>Buttons</a></li><li><a href=/RGB/docs/shortcodes/columns/>Columns</a></li><li><a href=/RGB/docs/shortcodes/details/>Details</a></li><li><a href=/RGB/docs/shortcodes/hints/>Hints</a></li><li><a href=/RGB/docs/shortcodes/katex/>Katex</a></li><li><a href=/RGB/docs/shortcodes/mermaid/>Mermaid</a></li><li><input type=checkbox id=section-ec67a64aba70b9df3d2a9acd6c92e3bc class=toggle>
<label for=section-ec67a64aba70b9df3d2a9acd6c92e3bc class="flex justify-between"><a href=/RGB/docs/shortcodes/p5/>P5</a></label><ul><li><a href=/RGB/docs/shortcodes/p5/div/>Div</a></li><li><a href=/RGB/docs/shortcodes/p5/iframe/>Iframe</a></li></ul></li><li><a href=/RGB/docs/shortcodes/tabs/>Tabs</a></li></ul></li><li><input type=checkbox id=section-042d3f228c0d48b7873225f7fc71e929 class=toggle checked>
<label for=section-042d3f228c0d48b7873225f7fc71e929 class="flex justify-between"><a href=/RGB/docs/Talleres/>Talleres</a></label><ul><li><a href=/RGB/docs/Talleres/Gray_Scale/>Gray Scale</a></li><li><a href=/RGB/docs/Talleres/Main-Spaces/>Main Spaces</a></li><li><a href=/RGB/docs/Talleres/Photomosaic/ class=active>Photomosaic</a></li><li><a href=/RGB/docs/Talleres/visual_ilusions/>Visual Ilusions</a></li><li><a href=/RGB/docs/Talleres/visual_Masking/>Visual Masking</a></li></ul></li></ul><ul><li><a href=/RGB/posts/>Blog</a></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/RGB/svg/menu.svg class=book-icon alt=Menu></label>
<strong>Photomosaic</strong>
<label for=toc-control><img src=/RGB/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#photomosaic>Photomosaic</a></li><li><a href=#background>Background</a><ul><li><a href=#fotomosaico>Fotomosaico</a></li><li><a href=#idea>Idea</a></li><li><a href=#división-de-la-imagen-original-en-partes-más-pequeñas>División de la imagen original en partes más pequeñas</a></li><li><a href=#promediando-los-valores-de-los-colores>Promediando los valores de los colores</a></li><li><a href=#eligiendo-la-mejor-imagen-para-un-recuadro>Eligiendo la mejor imagen para un recuadro</a></li></ul></li><li><a href=#implementación>Implementación</a><ul><li><a href=#imagen-original>Imagen original</a></li><li><a href=#dataset>Dataset</a></li><li><a href=#fotomosaico-1>Fotomosaico</a></li></ul></li><li><a href=#bibliografía>Bibliografía:</a></li></ul></nav></aside></header><article class=markdown><h1 id=photomosaic>Photomosaic
<a class=anchor href=#photomosaic>#</a></h1><blockquote class="book-hint info"><p><strong>Ejercicio 1</strong></p><ol><li>Implement a mosaic (or/and ascii art) visual application.</li></ol></blockquote><h1 id=background>Background
<a class=anchor href=#background>#</a></h1><h2 id=fotomosaico>Fotomosaico
<a class=anchor href=#fotomosaico>#</a></h2><p>En el campo de las imágenes y la fotografía, un fotomosaico es una imagen usualmente una fotografía que ha sido dividida en secciones rectangulares (usualmente del mismo tamaño), tal como es compuesto un mosaico tradicional, con la característica de que cada elemento del mosaico es reemplazado por otra fotografía con colores promedios apropiados al elemento de la imagen original. Cuando es vista en detalle, los píxeles individuales se ven como la imagen principal, sin embargo al verla como un todo, es posible apreciar que la imagen está compuesta por cientos de miles de imágenes.</p><img src=https://img.unocero.com/2019/07/unocero-photomosaic.jpg alt=Fotomosaico style=width:90%><h2 id=idea>Idea
<a class=anchor href=#idea>#</a></h2><p>En el tipo más avanzado de mosaico fotográfico, la imagen de destino no se reduce, y la coincidencia se realiza comparando cada píxel del rectángulo con el píxel correspondiente de cada imagen de la biblioteca. El rectángulo del objetivo se sustituye por la imagen de la biblioteca que minimiza la diferencia total. Esto requiere muchos más cálculos que el tipo simple, pero los resultados pueden ser mucho mejores, ya que la comparación píxel a píxel puede conservar la resolución de la imagen de destino.</p><blockquote class="book-hint info"><p><strong>¿Cómo crear fotomosaicos?</strong></p><ol><li>Lee las imagenes del dataset, que sustituirán los recuadros de la imagen original.</li><li>Leer la imagen original y dividirla en recuadros M x N formando el mosaico.</li><li>Para cada recuadro, encuentra la mejor coincidencia de las imagenes del dataset.</li><li>Crea el fotomosaico final disponiendo de las imagenes del dataset seleccionadas.</li></ol></blockquote><h2 id=división-de-la-imagen-original-en-partes-más-pequeñas>División de la imagen original en partes más pequeñas
<a class=anchor href=#divisi%c3%b3n-de-la-imagen-original-en-partes-m%c3%a1s-peque%c3%b1as>#</a></h2><img src=https://media.geeksforgeeks.org/wp-content/uploads/Capture_2-1.jpg alt=División style=width:90%><h2 id=promediando-los-valores-de-los-colores>Promediando los valores de los colores
<a class=anchor href=#promediando-los-valores-de-los-colores>#</a></h2><p>Cada píxel de una imagen tiene un color que puede ser representado por sus valores de rojo, verde y azul. En este caso, se están utilizando imágenes de 8 bits, por lo que cada uno de estos componentes tiene un valor de 8 bits en el rango [0, 255]. Dada una imagen con un total de N píxeles, el promedio RGB se calcula de la siguiente manera:</p><img src=https://www.geeksforgeeks.org/wp-content/ql-cache/quicklatex.com-34611203bc6570718be7cb97960bd09b_l3.svg alt="Promedio colores"><h2 id=eligiendo-la-mejor-imagen-para-un-recuadro>Eligiendo la mejor imagen para un recuadro
<a class=anchor href=#eligiendo-la-mejor-imagen-para-un-recuadro>#</a></h2><p>Para el fotomosaico, hay que encontrar una imagen coincidente entre las imágenes del dataset. Para determinar si la imágen coincide con el recuadro seleccionado, utilice los valores RGB medios. La coincidencia más cercana es la imagen con el valor RGB medio más próximo.</p><img src=https://www.geeksforgeeks.org/wp-content/ql-cache/quicklatex.com-4bfef269686704233f1e9efbbd7b94f9_l3.svg alt="eligiendo la mejor imagen"><h1 id=implementación>Implementación
<a class=anchor href=#implementaci%c3%b3n>#</a></h1><h2 id=imagen-original>Imagen original
<a class=anchor href=#imagen-original>#</a></h2><img src=/RGB/sketches/pesebre.png alt=Pesebre style=width:90%><h2 id=dataset>Dataset
<a class=anchor href=#dataset>#</a></h2><p>Los colores de cada imagen se guardan en un archivo TXT, estos serán precargados para puedan ser analizados y obtener su repesentación de color RGB.<br><img src=https://github.com/emmendezp/RGB/blob/ea2c572648c8f8120b18b9c0aabbd6007a344753/content/docs/Talleres/dataset.png alt=dataset></p><details><summary>Implementation of the Floyd-Steinberg Dithering algorithm</summary><div class=markdown-inner><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>picture</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>w_scaled</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>h_scaled</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>availableColors</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>dataset</span><span style=color:#f92672>=</span> [];
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>loadedImages</span> <span style=color:#f92672>=</span> [];
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>scaleFactor</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>6</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>datasetSize</span> <span style=color:#f92672>=</span><span style=color:#ae81ff>70</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>preload</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>location</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;imagen&#39;</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>picture</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>loadImage</span>(<span style=color:#a6e22e>location</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>loadStrings</span>(<span style=color:#e6db74>&#39;dataset.txt&#39;</span>,<span style=color:#a6e22e>loadDataset</span>)
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>noLoop</span>()
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>setup</span>() {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>createCanvas</span>(<span style=color:#ae81ff>600</span>, <span style=color:#ae81ff>600</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>noLoop</span>();
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>draw</span>() {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>w_scaled</span> <span style=color:#f92672>=</span> Math.<span style=color:#a6e22e>floor</span>(<span style=color:#a6e22e>picture</span>.<span style=color:#a6e22e>width</span> <span style=color:#f92672>/</span> <span style=color:#a6e22e>scaleFactor</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>h_scaled</span> <span style=color:#f92672>=</span> Math.<span style=color:#a6e22e>floor</span>(<span style=color:#a6e22e>picture</span>.<span style=color:#a6e22e>height</span> <span style=color:#f92672>/</span> <span style=color:#a6e22e>scaleFactor</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>picture</span>.<span style=color:#a6e22e>resize</span>(<span style=color:#a6e22e>w_scaled</span>,<span style=color:#a6e22e>h_scaled</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>picture</span>.<span style=color:#a6e22e>loadPixels</span>();
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span>(<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>x</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>x</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>w_scaled</span>; <span style=color:#a6e22e>x</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span>(<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>y</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>y</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>h_scaled</span>; <span style=color:#a6e22e>y</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>const</span> [<span style=color:#a6e22e>r</span>, <span style=color:#a6e22e>g</span>, <span style=color:#a6e22e>b</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>picture</span>.<span style=color:#a6e22e>get</span>(<span style=color:#a6e22e>x</span>, <span style=color:#a6e22e>y</span>);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>index</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>closestColor</span>(<span style=color:#a6e22e>r</span>,<span style=color:#a6e22e>g</span>,<span style=color:#a6e22e>b</span>);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>pixelImage</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>loadedImages</span>[<span style=color:#a6e22e>index</span>];
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>image</span>(<span style=color:#a6e22e>pixelImage</span>,<span style=color:#a6e22e>x</span><span style=color:#f92672>*</span><span style=color:#a6e22e>scaleFactor</span>, <span style=color:#a6e22e>y</span><span style=color:#f92672>*</span><span style=color:#a6e22e>scaleFactor</span>);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}</span></span></code></pre></div></div></details><h2 id=fotomosaico-1>Fotomosaico
<a class=anchor href=#fotomosaico-1>#</a></h2><iframe id=breath style=width:600px;height:600px srcdoc="
        <!DOCTYPE html>
        <html>
          <head>
            <script src=https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.2/p5.min.js></script>
            <script src=https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.2/addons/p5.sound.min.js></script>
            
            
            
            
            
            <script>
              
let picture;
let w_scaled;
let h_scaled;
let availableColors;
let dataset= [];
let loadedImages = [];
const scaleFactor = 6;
const datasetSize =70;

function preload() {
    const location = '/RGB/sketches/pesebre.png'
    picture = loadImage(location);
    loadStrings('/RGB/sketches/dataset.txt',loadDataset)
    noLoop()
}

function setup() {
    createCanvas(600, 600);
    noLoop();
}

function draw() {
    w_scaled = Math.floor(picture.width / scaleFactor);
    h_scaled = Math.floor(picture.height / scaleFactor);
    picture.resize(w_scaled,h_scaled);
    picture.loadPixels();
    for(let x = 0; x < w_scaled; x++) {
        for(let y = 0; y < h_scaled; y++) {
            const [r, g, b] = picture.get(x, y);
            const index = closestColor(r,g,b);
            const pixelImage = loadedImages[index];
            image(pixelImage,x*scaleFactor, y*scaleFactor);
        }
    }
}

function closestColor(r,g,b) {
    let minDistance = -1;
    let index;
    for (let i=0; i < datasetSize; ++i) {
        const img_i = dataset[i];
        let distance = dist(r,g,b,img_i[0],img_i[1],img_i[2]);
        if (minDistance == -1 || distance < minDistance) {
            minDistance = distance;
            index = i;
        }
    }
    noLoop();
    return index;
}

function loadDataset(availableColors){
    availableColors.slice(0,datasetSize).map(c => {
        const r = parseInt(c.substring(0,3),10);
        const g = parseInt(c.substring(4,7),10);
        const b = parseInt(c.substring(8,11),10);
        dataset.push([r,g,b]);
        loadImage(`/RGB/docs/Talleres/dataset/${c}`, il => { 
            il.resize(scaleFactor,scaleFactor);
            loadedImages.push(il);
        })
    })
    noLoop();
}

function keyPressed() {
    if (key === &#34;d&#34;) {
        image(picture,0,0);
    }
  }



            </script>
          </head>
          <body>
          </body>
        </html>
      "></iframe><h1 id=bibliografía>Bibliografía:
<a class=anchor href=#bibliograf%c3%ada>#</a></h1><ul><li><p>Artensoft. Archives of sample photos for photomosaic -Archive with christmas images. Recuperado el 12 de noviembre de 2022, de <a href=https://www.artensoft.com/ArtensoftPhotoMosaicWizard/photobases.php>https://www.artensoft.com/ArtensoftPhotoMosaicWizard/photobases.php</a></p></li><li><p>geeksforgeeks. Implementing Photomosaics by Subhajit Saha.. Recuperado el 12 de noviembre de 2022, de <a href=https://www.geeksforgeeks.org/implementing-photomosaics/>https://www.geeksforgeeks.org/implementing-photomosaics/</a></p></li><li><p>Github. Photo mosaic, SuperIRis . Recuperado el 12 de noviembre de 2022, de <a href=https://github.com/SuperIRis/photomosaic>https://github.com/SuperIRis/photomosaic</a></p></li><li><p>DEV. Convert images to mosaics in p5.js, &y H. Golang. Recuperado el 12 de noviembre de 2022, de <a href=https://dev.to/andyhaskell/convert-images-to-mosaics-in-p5js-2dlc>https://dev.to/andyhaskell/convert-images-to-mosaics-in-p5js-2dlc</a></p></li></ul></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/emmendezp/RGB/commit/3ad42f1a2afda0cdb620d85b430c41722331215a title='Last modified by Julio Javier Muñoz Quiñones | November 16, 2022' target=_blank rel=noopener><img src=/RGB/svg/calendar.svg class=book-icon alt=Calendar>
<span>November 16, 2022</span></a></div></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#photomosaic>Photomosaic</a></li><li><a href=#background>Background</a><ul><li><a href=#fotomosaico>Fotomosaico</a></li><li><a href=#idea>Idea</a></li><li><a href=#división-de-la-imagen-original-en-partes-más-pequeñas>División de la imagen original en partes más pequeñas</a></li><li><a href=#promediando-los-valores-de-los-colores>Promediando los valores de los colores</a></li><li><a href=#eligiendo-la-mejor-imagen-para-un-recuadro>Eligiendo la mejor imagen para un recuadro</a></li></ul></li><li><a href=#implementación>Implementación</a><ul><li><a href=#imagen-original>Imagen original</a></li><li><a href=#dataset>Dataset</a></li><li><a href=#fotomosaico-1>Fotomosaico</a></li></ul></li><li><a href=#bibliografía>Bibliografía:</a></li></ul></nav></div></aside></main></body></html>